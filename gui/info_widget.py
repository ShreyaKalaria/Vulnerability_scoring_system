# -*- coding: utf-8 -*-
"""
Created on Mon Sep 12 20:15:44 2022

@author: iit
"""

import sys

from PyQt5.QtWidgets import (
    QApplication, QDialog, QTableWidget,QWidget, QMainWindow, QMessageBox, QGroupBox, QLabel,
    QTableWidgetItem
)
from PyQt5.uic import loadUi



class Info_widget(QWidget):
    def __init__(self, parent=None):
        super().__init__(parent)
        loadUi("info.ui", self) # this ui file is a widget so it can be placed within qmainwindow
        # qdialog cannot be load on qmainwindow file
        self.maping = {
        'AV':{
            'N':'NETWORK',
            'A':'ADJACENT_NETWORK',
            'L':'LOCAL',
            'P':'PHYSICAL'
            },
        'AC':{
            'L':'LOW',
            'H':'HIGH'
            },
        'PR':{
            'N':'NONE',
            'L':'LOW',
            'H':'HIGH'
            },
        'UI':{
            'N':'NONE',
            'R':'REQUIRED'
            },
        'C':{
            'N':'NONE',
            'H':'HIGH',
            'L':'LOW'
            },
        'I':{
            'L':'NONE',
            'L':'HIGH',
            'L':'LOW'
            },
        'A':{
            'N':'NONE',
            'H':'HIGH',
            'L':'LOW'
            },
        }
    def setdata(self,data):
        met = data.vectorString_v31.split("/")
        print(self.maping[met[2].split(":")[0]][met[2].split(":")[1]])
        self.ac.setText(self.maping[met[2].split(":")[0]][met[2].split(":")[1]])
        self.au.setText(self.maping[met[3].split(":")[0]][met[3].split(":")[1]])
        self.av.setText("ac")
        self.pr.setText("ac")
        self.ci.setText("ac")
        self.ii.setText("ac")
        self.ai.setText("ac")
        
        self.id.setText(str(data.ID))
        self.vendors.setText("ac")
        self.products.setText("ac")
        
        self.date.setText(str(data.publishedDate))
        self.tags.setText("ac")
        self.codelinks.setText(str(data.code_link))
        
        self.ref_links.setText(str(data.url))
        # self.ref_source.setText(str(data.))
        
        self.desc.setText(str(data.description))
        
        
       