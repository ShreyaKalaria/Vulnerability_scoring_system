# -*- coding: utf-8 -*-
"""
Created on Sun Sep 11 15:47:46 2022

@author: iit
"""

#%% run
'''
!python cvss_epss_bar.py
'''
#%%
from PyQt5.QtWidgets import QApplication, QWidget, QVBoxLayout
from PyQt5.QtChart import QChart, QChartView, QBarSet,QPercentBarSeries, QBarCategoryAxis
import sys
from PyQt5.QtGui import QIcon
from PyQt5.QtCore import Qt
 
 
class Window(QWidget):
    def __init__(self):
        super().__init__()
 
 
        #window requirements
        # self.setGeometry(200,200,600,400)
        self.setWindowTitle("Creating Barchart")
        self.setWindowIcon(QIcon("python.png"))
 
        #change the color of the window
        self.setStyleSheet('background-color:green')
 
        #create barseries
        set0 = QBarSet("")
        set1 = QBarSet("")
        
 
 
        #insert data to the barseries
        set0 << 1 << 1 << 2 # for full row
        set1 << 4 << 4 << 3 # for empty row
 
        #we want to create percent bar series
        series = QPercentBarSeries()
        series.append(set0)
        series.append(set1)

        
 
        #create chart and add the series in the chart
        chart = QChart()
        chart.addSeries(series)
        # chart.setTitle("Barchart Percent Example")
        chart.setAnimationOptions(QChart.SeriesAnimations)
        pen = chart.backgroundPen()
        pen.setColor(Qt.blue)
        chart.setBackgroundPen(pen)
        
        # ----------- margin -----------
        
        margin = chart.margins()
        # print(dir(margin))
        # print(margin.__dict__)
        
        # print(margin.left())
        # print(margin.right())
        # print(margin.top())
        # print(margin.bottom())
        # margin.left = 0
        # margin.top = 0
        # margin.right = 0
        # margin.bottom = 0
        # chart.setMargins(margin)
        
        #------------
        # chart.setBackgroundVisible(False)
        # chart.setTheme(QChart.ChartThemeDark)
        set1.setColor(Qt.white)
 
        #create axis for the chart
        categories = ["CVSS2.0", "CVSS3.0", "EPSS"]
 
        axis = QBarCategoryAxis()
        axis.append(categories)
        # chart.createDefaultAxes()
        chart.setAxisX(axis)
 
        #create chartview and add the chart in the chartview
        chartview = QChartView(chart)
 
        vbox = QVBoxLayout()
        vbox.setContentsMargins(0,0,0,0)
        vbox.addWidget(chartview)
        # print(dir(vbox.getContentsMargins()))
 
        self.setLayout(vbox)
 
 
 
 
 
 
 
 
 
App = QApplication(sys.argv)
window = Window()
window.show()
sys.exit(App.exec())
