# -*- coding: utf-8 -*-
"""
Created on Wed Aug 10 21:05:00 2022

@author: IIT
"""
#%% getting vendor
data = pd.read_csv('../data/output/data_2019.csv')
data = data[['ID','cpe23Uri','url']]
data = data.dropna()
lst = data['cpe23Uri'].values.tolist()

vendor_lst = []
soft_lst = []
item = lst[0]
for item in lst:
    # if type(item == NoneType)
    tem_vendor = []
    temp_soft = []

    cpe_lst = item.split('#arman#')
    
    for a_cpe in cpe_lst:
        a_cpe_sp = a_cpe.split(':')
        
        vendor= a_cpe_sp[3]
        soft = a_cpe_sp[4]
        
        if vendor not in tem_vendor:
            # print(vendor,tem_vendor)
            tem_vendor.append(vendor)
        if soft not in temp_soft:
            temp_soft.append(soft)
    vendor_lst.append(','.join(tem_vendor))
    soft_lst.append(','.join(temp_soft))
            
df = pd.DataFrame()
df['ID'] = data['ID']
df['vendor'] = vendor_lst
df['software'] = soft_lst


#%% parsing git

url_lst = data['url'].values.tolist()

git_list = []

for url in url_lst:
    is_url = url.find('github')
    if is_url ==-1:
        git_list.append(None)
    else:
        git_list.append('yes')
        
df['github'] = git_list


df.to_csv('vedor_info.csv',index = False)
